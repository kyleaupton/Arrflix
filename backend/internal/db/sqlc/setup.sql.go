// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: setup.sql

package dbgen

import (
	"context"
)

const countUsers = `-- name: CountUsers :one
SELECT COUNT(*) FROM app_user
`

func (q *Queries) CountUsers(ctx context.Context) (int64, error) {
	row := q.db.QueryRow(ctx, countUsers)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getSystemInitialized = `-- name: GetSystemInitialized :one
SELECT (value_json)::bool as initialized
FROM app_setting
WHERE key = 'system.initialized'
`

func (q *Queries) GetSystemInitialized(ctx context.Context) (bool, error) {
	row := q.db.QueryRow(ctx, getSystemInitialized)
	var initialized bool
	err := row.Scan(&initialized)
	return initialized, err
}

const setSystemInitialized = `-- name: SetSystemInitialized :exec
UPDATE app_setting
SET value_json = 'true'::jsonb,
    updated_at = now(),
    version = version + 1
WHERE key = 'system.initialized'
  AND (value_json)::bool = false
`

func (q *Queries) SetSystemInitialized(ctx context.Context) error {
	_, err := q.db.Exec(ctx, setSystemInitialized)
	return err
}
