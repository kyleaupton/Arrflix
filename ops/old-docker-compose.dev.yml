services:
  snaggle-ops:
    build:
      context: .
      dockerfile: Dockerfile
    image: snaggle-ops:latest
    container_name: snaggle-ops-dev
    environment:
      RUNTIME_MODE: dev
      TMDB_API_KEY: ${TMDB_API_KEY}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      # Dev mode volume mounts for live reload
      - ../backend:/host/backend:ro
      - ../web:/host/web:ro
      # Mount parent directory for build context
      - ..:/host:ro
    networks:
      - snaggle-network
    ports:
      - "8484:8484" # Main web interface
      # - "8080:8080" # API dev server (direct access)
      # - "5173:5173" # Vite dev server (direct access)
    restart: unless-stopped

networks:
  snaggle-network:
    name: snaggle-network

volumes:
  snaggle_pg_data:
  snaggle_prowlarr_data:
  web_node_modules:
