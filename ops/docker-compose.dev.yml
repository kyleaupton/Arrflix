services:
  snaggle:
    build:
      context: ..
      dockerfile: ops/Dockerfile
      target: dev-runtime
    environment:
      RUNTIME_MODE: dev
      TMDB_API_KEY: ${TMDB_API_KEY}
    volumes:
      - ../backend:/app/backend
      - ../web:/web
      - web_node_modules:/web/node_modules
      - snaggle_pg_data:/var/lib/postgresql/data
    ports:
      - "8484:8484"
      - "9117:9117"
    restart: unless-stopped

volumes:
  snaggle_pg_data:
  web_node_modules:
